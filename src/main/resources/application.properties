spring.application.name=mybungalow

# Server
# Allow Railway (and other hosts) to set the port via the PORT env var.
server.port=${PORT:8080}
# Bind to all interfaces (helpful in container/cloud environments)
server.address=0.0.0.0

# Datasource
# Prefer environment-provided JDBC url (SPRING_DATASOURCE_URL) or Railway's MYSQL_URL / MYSQL_* variables.
# Resolution order:
# 1. SPRING_DATASOURCE_URL
# 2. MYSQL_URL (complete JDBC URL provided by Railway)
# 3. Constructed URL from MYSQLHOST / MYSQLPORT / MYSQLDATABASE (Railway provides MYSQLHOST as RAILWAY_PRIVATE_DOMAIN)
# 4. Local dev fallback
## Datasource URL: prefer environment-provided JDBC url, otherwise try MySQL (Railway),
## and as a final fallback use an in-memory H2 (useful for local development).
spring.datasource.url=${SPRING_DATASOURCE_URL:${MYSQL_URL:jdbc:mysql://${MYSQLHOST:${RAILWAY_PRIVATE_DOMAIN:127.0.0.1}}:${MYSQLPORT:3306}/${MYSQL_DATABASE:${MYSQLDATABASE:hotel_db}}?createDatabaseIfNotExist=true&useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC}:jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;MODE=MySQL}

# Username: prefer SPRING_DATASOURCE_USERNAME, then MYSQLUSER, then default to 'root'
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:${MYSQLUSER:root}}

# Password: prefer SPRING_DATASOURCE_PASSWORD, then MYSQLPASSWORD, then MYSQL_ROOT_PASSWORD, then empty
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:${MYSQLPASSWORD:${MYSQL_ROOT_PASSWORD:}}}

# JPA
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect

# Logging
logging.level.com.backend.mybungalow=DEBUG
logging.level.org.springframework.web=DEBUG

## CORS allowed origin for dev
app.cors.allowed-origin=*

# JWT Configuration
# Read secret from environment in production (JWT_SECRET). Keep a default for local dev only.
jwt.secret=${JWT_SECRET:mySecretKey123456789012345678901234567890}
jwt.expiration=${JWT_EXPIRATION_MS:86400000}


